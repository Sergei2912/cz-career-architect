<!DOCTYPE html>
<html lang='ru'>
<head>
    <meta charset='UTF-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <title>CZ Career Architect</title>
    <link href='https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap' rel='stylesheet'>
    <style>
        :root{--bg:#0f0f13;--bg-chat:#18181f;--bg-input:#1f1f28;--accent:#6366f1;--accent-light:#818cf8;--text:#f4f4f5;--text-dim:#a1a1aa;--border:#27272a;--success:#22c55e;--error:#ef4444}
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);height:100vh;display:flex;flex-direction:column}
        .header{padding:1rem 1.5rem;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:1rem;background:var(--bg-chat)}
        .avatar{width:44px;height:44px;background:linear-gradient(135deg,var(--accent),#a855f7);border-radius:12px;display:flex;align-items:center;justify-content:center;font-weight:600}
        .header-text h1{font-size:1.1rem}.header-text p{font-size:.8rem;color:var(--text-dim);display:flex;align-items:center;gap:6px}
        .status{width:8px;height:8px;border-radius:50%;background:var(--text-dim)}.status.online{background:var(--success)}
        .chat-area{flex:1;overflow-y:auto;padding:1.5rem;display:flex;flex-direction:column;gap:1rem}
        .welcome{text-align:center;padding:3rem 1rem;max-width:500px;margin:auto}
        .welcome-avatar{width:72px;height:72px;background:linear-gradient(135deg,var(--accent),#a855f7);border-radius:20px;display:flex;align-items:center;justify-content:center;font-size:2rem;margin:0 auto 1.5rem}
        .welcome h2{font-size:1.5rem;margin-bottom:.75rem}.welcome p{color:var(--text-dim);line-height:1.6;margin-bottom:2rem}
        .starter-prompts{display:flex;flex-direction:column;gap:.5rem}
        .starter-btn{background:var(--bg-input);border:1px solid var(--border);color:var(--text);padding:.875rem 1rem;border-radius:12px;text-align:left;cursor:pointer;font-family:inherit;font-size:.9rem;transition:all .2s}
        .starter-btn:hover{border-color:var(--accent);background:rgba(99,102,241,.1)}
        .message{display:flex;gap:.75rem;max-width:85%;animation:slideIn .3s}
        @keyframes slideIn{from{opacity:0;transform:translateY(8px)}to{opacity:1}}
        .message.user{align-self:flex-end;flex-direction:row-reverse}
        .msg-avatar{width:32px;height:32px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:.8rem;flex-shrink:0}
        .message.agent .msg-avatar{background:linear-gradient(135deg,var(--accent),#a855f7)}
        .message.user .msg-avatar{background:var(--bg-input);border:1px solid var(--border)}
        .msg-content{padding:.875rem 1rem;border-radius:16px;line-height:1.6;font-size:.9rem}
        .message.agent .msg-content{background:var(--border);border-bottom-left-radius:4px}
        .message.user .msg-content{background:var(--accent);border-bottom-right-radius:4px}
        .msg-content strong{color:var(--accent-light)}.msg-content code{background:rgba(0,0,0,.3);padding:2px 6px;border-radius:4px;font-size:.85em}
        .suggestions{display:flex;flex-wrap:wrap;gap:.5rem;margin-top:.75rem}
        .suggestion-btn{background:0;border:1px solid var(--border);color:var(--text-dim);padding:.4rem .75rem;border-radius:16px;font-size:.8rem;cursor:pointer;font-family:inherit;transition:all .2s}
        .suggestion-btn:hover{border-color:var(--accent);color:var(--text)}
        .typing{display:flex;gap:4px;padding:.5rem}
        .typing span{width:6px;height:6px;background:var(--text-dim);border-radius:50%;animation:typing 1.4s infinite}
        .typing span:nth-child(2){animation-delay:.2s}.typing span:nth-child(3){animation-delay:.4s}
        @keyframes typing{0%,60%,100%{transform:translateY(0)}30%{transform:translateY(-4px)}}
        .input-area{padding:1rem 1.5rem 1.5rem;background:var(--bg-chat);border-top:1px solid var(--border)}
        .pending-files{display:none;flex-wrap:wrap;gap:.5rem;margin-bottom:.75rem}.pending-files.show{display:flex}
        .pending-file{display:flex;align-items:center;gap:.5rem;background:var(--bg-input);padding:.5rem .75rem;border-radius:8px;font-size:.8rem;border:1px solid var(--border)}
        .pending-file button{background:0;border:0;color:var(--text-dim);cursor:pointer}.pending-file button:hover{color:var(--error)}
        .input-row{display:flex;gap:.75rem;align-items:flex-end}
        .input-box{flex:1;background:var(--bg-input);border:1px solid var(--border);border-radius:16px;padding:.25rem .5rem;transition:all .2s}
        .input-box:focus-within{border-color:var(--accent)}
        .input-box textarea{width:100%;background:0;border:0;color:var(--text);font-family:inherit;font-size:.9rem;padding:.75rem;resize:none;min-height:24px;max-height:120px;line-height:1.5}
        .input-box textarea::placeholder{color:var(--text-dim)}.input-box textarea:focus{outline:0}
        .btn-upload,.btn-send{width:44px;height:44px;border:0;border-radius:12px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s}
        .btn-upload{background:var(--bg-input);border:1px solid var(--border);color:var(--text-dim)}.btn-upload:hover{background:var(--accent);border-color:var(--accent);color:#fff}
        .btn-send{background:var(--accent);color:#fff}.btn-send:hover:not(:disabled){background:var(--accent-light)}.btn-send:disabled{opacity:.4;cursor:not-allowed}
        .btn-upload svg,.btn-send svg{width:20px;height:20px}
        input[type=file]{display:none}
        .toast{position:fixed;bottom:100px;left:50%;transform:translateX(-50%);background:var(--error);color:#fff;padding:.75rem 1.25rem;border-radius:8px;font-size:.85rem;display:none;z-index:100}.toast.show{display:block}
        .msg-file{display:flex;align-items:center;gap:.75rem;background:rgba(0,0,0,.2);padding:.625rem .875rem;border-radius:8px;margin-top:.5rem;font-size:.85rem}
    </style>
</head>
<body>
    <header class='header'>
        <div class='avatar'>CZ</div>
        <div class='header-text'><h1>CZ Career Architect</h1><p><span class='status' id='status'></span><span id='status-text'>–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</span></p></div>
    </header>
    <div class='chat-area' id='chat-area'>
        <div class='welcome' id='welcome'>
            <div class='welcome-avatar'>üëã</div>
            <h2>–ü—Ä–∏–≤–µ—Ç! –Ø —Ç–≤–æ–π HR-–ø–æ–º–æ—â–Ω–∏–∫</h2>
            <p>–ü–æ–º–æ–≥—É —Å–æ–∑–¥–∞—Ç—å —Ä–µ–∑—é–º–µ –∏ –º–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω–æ–µ –ø–∏—Å—å–º–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤ –ß–µ—Ö–∏–∏. –ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏, —á—Ç–æ —Ç–µ–±–µ –Ω—É–∂–Ω–æ!</p>
            <div class='starter-prompts'>
                <button class='starter-btn' data-msg='–ü—Ä–∏–≤–µ—Ç! –ú–Ω–µ –Ω—É–∂–Ω–æ —Ä–µ–∑—é–º–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã –∑—É–±–Ω—ã–º –≤—Ä–∞—á–æ–º'><span>üìÑ</span> –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑—é–º–µ</button>
                <button class='starter-btn' data-msg='–ü–æ–º–æ–≥–∏ –Ω–∞–ø–∏—Å–∞—Ç—å –º–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω–æ–µ –ø–∏—Å—å–º–æ –¥–ª—è –±–æ–ª—å–Ω–∏—Ü—ã'><span>‚úâÔ∏è</span> –ù–∞–ø–∏—Å–∞—Ç—å –ø–∏—Å—å–º–æ</button>
                <button class='starter-btn' data-msg='–ß—Ç–æ –Ω–µ–ª—å–∑—è —É–∫–∞–∑—ã–≤–∞—Ç—å –≤ —Ä–µ–∑—é–º–µ –ø–æ GDPR?'><span>‚ùì</span> –í–æ–ø—Ä–æ—Å –ø–æ GDPR</button>
                <button class='starter-btn' data-msg='–†–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ –Ω–æ—Å—Ç—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é –¥–∏–ø–ª–æ–º–∞'><span>üéì</span> –ü—Ä–æ –Ω–æ—Å—Ç—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é</button>
            </div>
        </div>
    </div>
    <div class='input-area'>
        <div class='pending-files' id='pending-files'></div>
        <div class='input-row'>
            <div class='input-box'><textarea id='input' placeholder='–ù–∞–ø–∏—à–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ...' rows='1'></textarea></div>
            <div style='display:flex;gap:.5rem'>
                <button class='btn-upload' id='btn-upload'><svg viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'><path d='M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4'/><polyline points='17 8 12 3 7 8'/><line x1='12' y1='3' x2='12' y2='15'/></svg></button>
                <button class='btn-send' id='btn-send' disabled><svg viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'><path d='M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z'/></svg></button>
            </div>
        </div>
    </div>
    <input type='file' id='file-input' multiple accept='.pdf,.docx,.doc,.txt'>
    <div class='toast' id='toast'></div>
    <script>
        const API='http://localhost:8000';
        const chatArea=document.getElementById('chat-area'),welcome=document.getElementById('welcome'),input=document.getElementById('input'),btnSend=document.getElementById('btn-send'),btnUpload=document.getElementById('btn-upload'),fileInput=document.getElementById('file-input'),pendingFilesEl=document.getElementById('pending-files'),status=document.getElementById('status'),statusText=document.getElementById('status-text'),toast=document.getElementById('toast');
        let sessionId=localStorage.getItem('sessionId'),pendingFiles=[],uploadedIds=[];
        const icons={pdf:'üìï',docx:'üìò',doc:'üìò',txt:'üìÑ'},getIcon=n=>icons[n.split('.').pop().toLowerCase()]||'üìé',formatSize=b=>b<1024?b+' B':b<1048576?(b/1024).toFixed(1)+' KB':(b/1048576).toFixed(1)+' MB';
        function showToast(m){toast.textContent=m;toast.classList.add('show');setTimeout(()=>toast.classList.remove('show'),3000)}
        async function checkStatus(){try{const r=await fetch(API+'/health');if(r.ok){status.classList.add('online');statusText.textContent='–û–Ω–ª–∞–π–Ω'}}catch{status.classList.remove('online');statusText.textContent='–û—Ñ–ª–∞–π–Ω'}}
        async function uploadFile(f){const fd=new FormData();fd.append('file',f);try{const r=await fetch(API+'/upload',{method:'POST',body:fd});if(!r.ok)throw new Error((await r.json()).detail);return await r.json()}catch(e){showToast('–û—à–∏–±–∫–∞: '+e.message);return null}}
        async function sendMsg(text,fids=[]){try{const r=await fetch(API+'/chat',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({message:text,session_id:sessionId,file_ids:fids})});if(!r.ok)throw new Error();const d=await r.json();sessionId=d.session_id;localStorage.setItem('sessionId',sessionId);return d}catch{return{response:'–°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ó–∞–ø—É—Å—Ç–∏—Ç–µ: python api.py',suggestions:[]}}}
        function addMsg(text,type,files=[],sugg=[]){const div=document.createElement('div');div.className='message '+type;let c=fmt(text);if(files.length)c+=files.map(f=>'<div class="msg-file"><span>'+getIcon(f.name)+'</span><span>'+f.name+'</span><span style="color:var(--text-dim);font-size:.75rem">'+formatSize(f.size)+'</span></div>').join('');if(sugg.length&&type==='agent')c+='<div class="suggestions">'+sugg.map(s=>'<button class="suggestion-btn" data-msg="'+s+'">'+s+'</button>').join('')+'</div>';div.innerHTML='<div class="msg-avatar">'+(type==='agent'?'CZ':'üë§')+'</div><div class="msg-content">'+c+'</div>';chatArea.appendChild(div);chatArea.scrollTop=chatArea.scrollHeight;div.querySelectorAll('.suggestion-btn').forEach(b=>{b.onclick=()=>{input.value=b.dataset.msg;updateBtn();send()}})}
        function showTyping(){const d=document.createElement('div');d.className='message agent';d.id='typing';d.innerHTML='<div class="msg-avatar">CZ</div><div class="msg-content"><div class="typing"><span></span><span></span><span></span></div></div>';chatArea.appendChild(d);chatArea.scrollTop=chatArea.scrollHeight}
        function hideTyping(){document.getElementById('typing')?.remove()}
        function fmt(t){return t.replace(/\*\*(.*?)\*\*/g,'<strong>$1</strong>').replace(/`([^`]+)`/g,'<code>$1</code>').replace(/\n/g,'<br>')}
        function updateBtn(){btnSend.disabled=!input.value.trim()&&!pendingFiles.length}
        function renderFiles(){if(!pendingFiles.length){pendingFilesEl.classList.remove('show');return}pendingFilesEl.classList.add('show');pendingFilesEl.innerHTML=pendingFiles.map((f,i)=>'<div class="pending-file"><span>'+getIcon(f.name)+'</span><span>'+f.name+'</span><button data-i="'+i+'">‚úï</button></div>').join('');pendingFilesEl.querySelectorAll('button').forEach(b=>{b.onclick=()=>{pendingFiles.splice(+b.dataset.i,1);renderFiles();updateBtn()}})}
        async function send(){const text=input.value.trim();if(!text&&!pendingFiles.length)return;welcome.style.display='none';addMsg(text||'–§–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω','user',pendingFiles);const toUp=[...pendingFiles];input.value='';input.style.height='auto';pendingFiles=[];renderFiles();updateBtn();showTyping();for(const f of toUp){const r=await uploadFile(f);if(r)uploadedIds.push(r.id)}const res=await sendMsg(text||'–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ñ–∞–π–ª',uploadedIds);hideTyping();addMsg(res.response,'agent',[],res.suggestions||[])}
        input.oninput=()=>{input.style.height='auto';input.style.height=Math.min(input.scrollHeight,120)+'px';updateBtn()};
        input.onkeydown=e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();send()}};
        btnSend.onclick=send;btnUpload.onclick=()=>fileInput.click();
        fileInput.onchange=e=>{const files=[...e.target.files].filter(f=>{const ext=f.name.split('.').pop().toLowerCase();if(!['pdf','docx','doc','txt'].includes(ext)){showToast(f.name+': —Ñ–æ—Ä–º–∞—Ç');return false}if(f.size>10485760){showToast(f.name+': >10MB');return false}return true});pendingFiles=[...pendingFiles,...files];renderFiles();updateBtn();fileInput.value=''};
        document.querySelectorAll('.starter-btn').forEach(b=>{b.onclick=()=>{input.value=b.dataset.msg;updateBtn();send()}});
        document.ondragover=e=>e.preventDefault();document.ondrop=e=>{e.preventDefault();if(e.dataTransfer.files.length){fileInput.files=e.dataTransfer.files;fileInput.dispatchEvent(new Event('change'))}};
        checkStatus();setInterval(checkStatus,10000);input.focus();
    </script>
</body>
</html>